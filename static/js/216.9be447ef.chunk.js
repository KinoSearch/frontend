"use strict";(self.webpackChunkkinosearch_v2=self.webpackChunkkinosearch_v2||[]).push([[216],{5216:function(e,r,t){t.r(r);var a=t(1413),s=t(7762),n=t(4165),i=t(5861),c=t(9439),o=t(7313),l=t(4390),u=t(3964),d=t(720),m=t(3068),h=t(9748),p=t(5627),f=t(2335),x=t(1881),v=t.n(x),b=t(7890),g=t(9466),j=t(1875),Z=t(7519),k=t(6417);r.default=function(){var e=(0,l.pm)(),r=o.useState(!1),t=(0,c.Z)(r,2),x=t[0],y=t[1],w=o.useState(null),_=(0,c.Z)(w,2),C=_[0],E=_[1],S=(0,b.s0)();o.useEffect((function(){var e=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var r,t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v().get("".concat(f.Z.ks_api,"/user/info"),{headers:{Authorization:"Bearer ".concat((0,Z.YT)())}});case 3:r=e.sent,t=r.data,E(t.user),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),S("/login");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var I=(0,p.cI)(),q=I.register,z=I.handleSubmit,B=I.formState.errors,F=I.setError,T=z(function(){var r=(0,i.Z)((0,n.Z)().mark((function r(t){var a,i,c,o,l,u,d,m,h,p;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(y(!0),r.prev=1,a=!1,/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(t.email)||(F("email",{type:"custom",message:"Email \u0432\u0432\u0435\u0434\u0435\u043d \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e"}),a=!0),!a){r.next=6;break}return r.abrupt("return");case 6:return r.next=8,v().post("".concat(f.Z.ks_api,"/user/change_email"),t,{headers:{Authorization:"Bearer ".concat((0,Z.YT)())}});case 8:if(i=r.sent,(c=i.data).errors){o=(0,s.Z)(c.errors);try{for(o.s();!(l=o.n()).done;)"Email \u0437\u0430\u043d\u044f\u0442"===(u=l.value).message&&F("email",{type:"custom",message:u.message})}catch(p){o.e(p)}finally{o.f()}}else e({title:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b",status:"success",duration:3e3,isClosable:!0,variant:"left-accent",position:"bottom-left"});r.next=16;break;case 13:if(r.prev=13,r.t0=r.catch(1),r.t0.response.data){d=r.t0.response.data;try{m=(0,s.Z)(d.errors);try{for(m.s();!(h=m.n()).done;)"Email \u0437\u0430\u043d\u044f\u0442"===(p=h.value).message&&F("email",{type:"custom",message:p.message})}catch(p){m.e(p)}finally{m.f()}}catch(n){e({title:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430",description:"".concat(r.t0),status:"error",duration:3e3,isClosable:!0,variant:"left-accent",position:"bottom-left"})}}else e({title:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430",description:"".concat(r.t0),status:"error",duration:3e3,isClosable:!0,variant:"left-accent",position:"bottom-left"});case 16:return r.prev=16,y(!1),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[1,13,16,19]])})));return function(e){return r.apply(this,arguments)}}());return(0,k.jsx)(k.Fragment,{children:!C&&(0,k.jsx)(j.Z,{})||(0,k.jsx)(u.xu,{w:"100%",paddingTop:[10,0],children:(0,k.jsx)(u.M5,{children:(0,k.jsx)(u.W2,{maxW:["full","sm"],children:(0,k.jsx)("form",{onSubmit:T,children:(0,k.jsxs)(u.Kq,{direction:"column",spacing:5,children:[(0,k.jsx)(u.M5,{children:(0,k.jsx)(u.X6,{children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"})}),(0,k.jsxs)(u.Kq,{direction:"column",spacing:2,children:[(0,k.jsxs)(d.NI,{isInvalid:!!B.email,children:[(0,k.jsx)(m.II,(0,a.Z)({placeholder:"Email",borderColor:"#929292",defaultValue:C.email,isDisabled:x,focusBorderColor:"brand.500",_placeholder:{color:"white"}},q("email",{required:!0}))),B.email&&(0,k.jsx)(d.J1,{children:"required"===B.email.type&&(0,k.jsx)(k.Fragment,{children:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 Email"})||(0,k.jsx)(k.Fragment,{children:B.email.message})})]}),(0,k.jsx)(u.rU,{color:"brand.500",_hover:{color:"brand.600",textDecoration:"none"},as:g.rU,to:"/settings/password_change",children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]}),(0,k.jsx)(h.zx,{w:"100%",isLoading:x,type:"submit",colorScheme:"brand",size:"md",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})})})})})})}}}]);