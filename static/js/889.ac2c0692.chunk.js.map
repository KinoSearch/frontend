{"version":3,"file":"static/js/889.ac2c0692.chunk.js","mappings":"2RAKMA,EAAK,yCAAG,WAAOC,GAAP,+FAENC,IAAAA,KAAA,UAAcC,EAAAA,EAAAA,OAAd,0BAA6CF,GAAU,KAAM,CAClEG,QAAS,CACRC,cAAc,UAAD,QAAYC,EAAAA,EAAAA,UAJf,8GAAH,sD,SC2FX,MAvFA,WACC,IAAML,GAAWM,EAAAA,EAAAA,MAAXN,OACN,EAAgCO,EAAAA,UAAwB,GAAxD,eAAOC,EAAP,KAAiBC,EAAjB,KACA,EAA0BF,EAAAA,SAAuB,IAAjD,eAAOG,EAAP,KAAcC,EAAd,KACA,EAAkCJ,EAAAA,UAAwB,GAA1D,eAAOK,EAAP,KAAkBC,EAAlB,KACA,EAAkCN,EAAAA,SAA8B,MAAhE,eAAOO,EAAP,KAAkBC,EAAlB,KAmCA,OAlCAR,EAAAA,WAAgB,WACf,IAAMS,EAAK,yCAAG,oGACbP,GAAY,GACZI,GAAa,GACbE,EAAa,MAHA,kBAKMd,IAAAA,IAAA,UAAaC,EAAAA,EAAAA,QAAb,kBAAqCF,GAAU,CAChEG,QAAS,CACR,YAAaD,EAAAA,EAAAA,aAPH,UAWO,OANbe,EALM,QAWJC,OAXI,wBAYXP,EAASM,EAAIE,KAAKC,QAAUH,EAAIE,KAAKE,QACrCZ,GAAY,GAbD,oBAeqBR,IAAAA,KAAA,UAC3BC,EAAAA,EAAAA,OAD2B,mBACHF,IAhBlB,iBAeIsB,EAfJ,EAeFH,KAGRJ,EAAaO,EAAOA,QAEpBC,EAASvB,GApBC,mFAuBXS,GAAY,GAvBD,0DA0BZA,GAAY,GA1BA,yBA4BZI,GAAa,GA5BD,qFAAH,qDA+BXG,GACA,GAAE,CAAChB,KAEH,yBACGY,IACD,4BACC,SAAC,IAAD,CAAOF,MAAM,gBACb,SAACc,EAAA,EAAD,SAGD,yBACGhB,IACD,UAAC,KAAD,CAAQiB,EAAE,OAAV,WACC,SAAC,IAAD,CAAOf,MAAM,gIACb,SAAC,KAAD,4HAGD,4BACC,SAAC,IAAD,CAAOA,MAAM,6GACb,SAAC,KAAD,CAAQgB,cAAe,GAAvB,UACC,SAAC,KAAD,CAASC,KAAK,KAAKC,WAAW,MAA9B,SACElB,MAGDI,IACD,SAAC,KAAD,CAAWW,EAAG,CAAC,OAAQ,QAAvB,UACC,mBACCf,MAAM,SACNmB,IAAKf,EACLgB,YAAa,EACbC,iBAAe,EACfC,MAAO,CAAEC,MAAO,OAAQC,OAAQ,cAIlC,SAAC,KAAD,WACC,SAAC,KAAD,CAASP,KAAK,KAAKC,WAAW,MAA9B,iSAWR,C","sources":["hooks/History.ts","pages/Watch.tsx"],"sourcesContent":["import axios from \"axios\";\nimport { GetToken } from \"./Auth\";\nimport React from \"react\";\nimport config from \"../config\";\n\nconst Watch = async (filmId: any) => {\n\ttry {\n\t\tawait axios.post(`${config.ks_api}/history/watch/${filmId}`, null, {\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${GetToken()}`,\n\t\t\t},\n\t\t});\n\t} catch {}\n};\n\ninterface IWatch {\n\tnameRu?: string;\n\tnameEn?: string;\n\tnameOriginal?: string;\n\tposterUrl: string;\n\tposterUrlPreview: string;\n\twatchedAt: Date;\n\tkinopoiskId: number;\n}\n\nconst List = () => {\n\tconst [list, setList] = React.useState<IWatch[] | []>([]);\n\n\tconst ApiGetList = async () => {\n\t\ttry {\n\t\t\tconst { data: res } = await axios.get(`${config.ks_api}/history/list`, {\n\t\t\t\theaders: {\n\t\t\t\t\tAuthorization: `Bearer ${GetToken()}`,\n\t\t\t\t},\n\t\t\t});\n\t\t\tsetList(res.history);\n\t\t} catch {}\n\t};\n\tApiGetList();\n\n\treturn list;\n};\n\nconst Clear = async () => {\n\ttry {\n\t\tawait axios.post(`${config.ks_api}/history/list/clear`, null, {\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${GetToken()}`,\n\t\t\t},\n\t\t});\n\t} catch {}\n};\n\nexport { Watch, List, Clear };\n","import React from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport config from \"../config\";\nimport axios from \"axios\";\nimport { Title } from \"react-head-meta\";\nimport { Center, Heading, Container } from \"@chakra-ui/react\";\nimport Loader from \"../components/Loader\";\nimport { Watch as WTracker } from \"../hooks/History\";\n\nfunction Watch() {\n\tlet { filmId } = useParams();\n\tconst [notFound, setNotFound] = React.useState<boolean>(false);\n\tconst [title, setTitle] = React.useState<string>(\"\");\n\tconst [isLoading, setIsLoading] = React.useState<boolean>(true);\n\tconst [playerUrl, setPlayerUrl] = React.useState<string | null>(null);\n\tReact.useEffect(() => {\n\t\tconst check = async () => {\n\t\t\tsetNotFound(false);\n\t\t\tsetIsLoading(true);\n\t\t\tsetPlayerUrl(null);\n\t\t\ttry {\n\t\t\t\tconst res = await axios.get(`${config.api_url}/films/${filmId}`, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"X-API-KEY\": config.api_token,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tif (res.status === 200) {\n\t\t\t\t\tsetTitle(res.data.nameRu || res.data.nameEn);\n\t\t\t\t\tsetNotFound(false);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst { data: player } = await axios.post(\n\t\t\t\t\t\t\t`${config.ks_api}/player/${filmId}`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetPlayerUrl(player.player);\n\n\t\t\t\t\t\tWTracker(filmId);\n\t\t\t\t\t} catch {}\n\t\t\t\t} else {\n\t\t\t\t\tsetNotFound(true);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsetNotFound(true);\n\t\t\t} finally {\n\t\t\t\tsetIsLoading(false);\n\t\t\t}\n\t\t};\n\t\tcheck();\n\t}, [filmId]);\n\treturn (\n\t\t<div>\n\t\t\t{(isLoading && (\n\t\t\t\t<div>\n\t\t\t\t\t<Title title=\"KinoSearch\" />\n\t\t\t\t\t<Loader />\n\t\t\t\t</div>\n\t\t\t)) || (\n\t\t\t\t<div>\n\t\t\t\t\t{(notFound && (\n\t\t\t\t\t\t<Center h=\"80vh\">\n\t\t\t\t\t\t\t<Title title=\"Страница не найдена – KinoSearch\" />\n\t\t\t\t\t\t\t<Heading>Страница не найдена</Heading>\n\t\t\t\t\t\t</Center>\n\t\t\t\t\t)) || (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Title title=\"Просмотр фильма – KinoSearch\" />\n\t\t\t\t\t\t\t<Center paddingBottom={10}>\n\t\t\t\t\t\t\t\t<Heading size=\"xl\" fontWeight=\"800\">\n\t\t\t\t\t\t\t\t\t{title}\n\t\t\t\t\t\t\t\t</Heading>\n\t\t\t\t\t\t\t</Center>\n\t\t\t\t\t\t\t{(playerUrl && (\n\t\t\t\t\t\t\t\t<Container h={[\"auto\", \"50vh\"]}>\n\t\t\t\t\t\t\t\t\t<iframe\n\t\t\t\t\t\t\t\t\t\ttitle=\"player\"\n\t\t\t\t\t\t\t\t\t\tsrc={playerUrl}\n\t\t\t\t\t\t\t\t\t\tframeBorder={0}\n\t\t\t\t\t\t\t\t\t\tallowFullScreen\n\t\t\t\t\t\t\t\t\t\tstyle={{ width: \"100%\", height: \"100%\" }}\n\t\t\t\t\t\t\t\t\t></iframe>\n\t\t\t\t\t\t\t\t</Container>\n\t\t\t\t\t\t\t)) || (\n\t\t\t\t\t\t\t\t<Center>\n\t\t\t\t\t\t\t\t\t<Heading size=\"md\" fontWeight=\"600\">\n\t\t\t\t\t\t\t\t\t\tВ данный момент, плеер недоступен. Попробуйте позже.\n\t\t\t\t\t\t\t\t\t</Heading>\n\t\t\t\t\t\t\t\t</Center>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\nexport default Watch;\n"],"names":["Watch","filmId","axios","config","headers","Authorization","GetToken","useParams","React","notFound","setNotFound","title","setTitle","isLoading","setIsLoading","playerUrl","setPlayerUrl","check","res","status","data","nameRu","nameEn","player","WTracker","Loader","h","paddingBottom","size","fontWeight","src","frameBorder","allowFullScreen","style","width","height"],"sourceRoot":""}